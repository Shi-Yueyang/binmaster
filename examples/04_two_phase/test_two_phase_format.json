{
  "endianness": "little",
  "description": "Test format with functional fields and arbitrary scopes",
  "fields": [
    {
      "name": "magic",
      "type": "uint32"
    },
    {
      "name": "version",
      "type": "uint16"
    },
    {
      "name": "flags",
      "type": "uint16"
    },
    {
      "name": "data_count",
      "type": "uint8"
    },
    {
      "name": "data_array",
      "type": "array",
      "length_field": "data_count",
      "element_type": "uint32"
    },
    {
      "name": "header_crc",
      "type": "uint32",
      "function": "crc32",
      "function_scope": "field_range",
      "function_scope_start": "magic",
      "function_scope_end": "flags"
    },
    {
      "name": "data_checksum",
      "type": "uint8",
      "function": "checksum",
      "function_scope": "from_field",
      "function_scope_start": "data_count",
      "function_parameters": {
        "algorithm": "xor"
      }
    },
    {
      "name": "total_crc",
      "type": "uint32",
      "function": "crc32",
      "function_scope": "all_previous"
    },
    {
      "name": "calculated_size",
      "type": "uint32",
      "function": "file_size"
    }
  ]
}